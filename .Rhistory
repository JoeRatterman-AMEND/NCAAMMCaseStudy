library(XML)
library(RCurl)
library(rvest)
library(stringr)
library(data.table)
getKenPomYearData <- function(year){
theUrl <- paste0("https://kenpom.com/index.php?y=", as.character(year))
page <- read_html(theUrl)
tables <- page %>% html_nodes("table") %>% html_table()
data <- as.data.frame(tables[1])
colnames(data) <- c("Rank", "Team", "Conf", "Record", "AdjEM", "AdjO",
"AdjO_R", "AdjD", "AdjD_R", "AdjT", "AdjT_R",
"Luck", "Luck_R", "SoS_AdjEM", "SoS_AdjEM_R",
"OppO", "OppO_R", "OppD", "OppD_R", "NC_AdjEM", "NC_AdjEM_R")
data <- data %>% filter(!str_detect(Rank, "Rk")) # Remove label row
data <- data %>% filter(nchar(as.character(Rank)) > 0) %>% as_tibble() # Remove empty rank rows.
data$Year = year
return(data)
}
# Sample of pulling 2020 KenPom data
kenpom <- getKenPomYearData(2020)
kenpom
getKenPomYearData <- function(year){
theUrl <- paste0("https://kenpom.com/index.php?y=", as.character(year))
page <- read_html(theUrl)
tables <- page %>% html_nodes("table") %>% html_table()
data <- as.data.frame(tables[1])
colnames(data) <- c("Rank", "Team", "Conf", "Record", "AdjEM", "AdjO",
"AdjO_R", "AdjD", "AdjD_R", "AdjT", "AdjT_R",
"Luck", "Luck_R", "SoS_AdjEM", "SoS_AdjEM_R",
"OppO", "OppO_R", "OppD", "OppD_R", "NC_AdjEM", "NC_AdjEM_R")
data <- data %>% filter(!str_detect(Rank, "Rk")) # Remove label row
data <- data %>% filter(nchar(as.character(Rank)) > 0) %>% as_tibble() # Remove empty rank rows.
data$Year = year
return(data)
}
# Sample of pulling 2020 KenPom data
kenpom <- getKenPomYearData(2020)
getKenPomYearData <- function(year){
theUrl <- paste0("https://kenpom.com/index.php?y=", as.character(year))
page <- read_html(theUrl)
tables <- page %>% html_nodes("table") %>% html_table()
data <- as.data.frame(tables[1])
colnames(data) <- c("Rank", "Team", "Conf", "Record", "AdjEM", "AdjO",
"AdjO_R", "AdjD", "AdjD_R", "AdjT", "AdjT_R",
"Luck", "Luck_R", "SoS_AdjEM", "SoS_AdjEM_R",
"OppO", "OppO_R", "OppD", "OppD_R", "NC_AdjEM", "NC_AdjEM_R")
data <- data %>% filter(!str_detect(Rank, "Rk")) # Remove label row
data <- data %>% filter(nchar(as.character(Rank)) > 0) %>% as_tibble() # Remove empty rank rows.
data$Year = year
return(data)
}
